### prompt
今日shell脚本需求:
有一台服务器作为web应用，有一个目录（/data/web/attachment）
不定时地会被用户上传新的文件，但是不知道什么时候会上传。
所以，需要我们每5分钟做一次检测是否有新文件生成。
写一个shell脚本去完成检测。检测完成后若是有新文件，
还需要将新文件的列表输出到一个按年、月、日、时、分为名字的日志里。
思路： 每5分钟检测一次，那肯定需要有一个计划任务，每5分钟去执行一次。
脚本检测的时候，就是使用find命令查找5分钟内有过更新的文件，
若是有更新，那这个命令会输出东西，否则是没有输出的。
固，我们可以把输出结果的行数作为比较对象，看看它是否大于0。

### chatgpt
为了完成这个需求，我们需要编写一个Shell脚本，它将定期检查/data/web/attachment目录下是否有新文件，并将新文件的列表写入到一个日志文件中。这个日志文件的名称将基于当前的年、月、日、时和分来创建。以下是一个基本的脚本示例来实现这个功能：
```#!/bin/bash

# 定义检测的目录
DIRECTORY="/data/web/attachment"

# 定义日志文件的前缀路径
LOG_PATH="/var/log/webapp"

# 获取当前时间作为日志文件的一部分
LOG_FILE="${LOG_PATH}/$(date '+%Y-%m-%d-%H-%M').log"

# 使用find命令查找在过去5分钟内被修改或创建的文件
# -mmin -5 用于找出在过去5分钟内被修改的文件
# -type f 指定只查找文件
# 如果没有文件被修改或创建，find命令将不会输出任何内容
NEW_FILES=$(find $DIRECTORY -type f -mmin -5)

# 检查是否有新文件
if [ ! -z "$NEW_FILES" ]; then
    # 如果有新文件，将文件列表写入日志
    echo "$NEW_FILES" > "$LOG_FILE"
fi

# 将此脚本添加到crontab中以每5分钟执行一次
# */5 * * * * /path/to/this/script.sh
```
这个脚本会每5分钟检查一次指定目录下是否有新文件。如果有，它会把这些新文件的路径写入一个日志文件中。这个日志文件的名称会包含脚本运行时的年、月、日、时和分。

